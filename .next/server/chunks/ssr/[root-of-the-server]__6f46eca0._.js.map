{"version":3,"sources":["../../../../node_modules/.pnpm/next%4016.1.0_%40babel%2Bcore%407.28.5_react-dom%4019.2.3_react%4019.2.3__react%4019.2.3/node_modules/next/src/server/route-modules/app-page/vendored/contexts/app-router-context.ts","../../../../node_modules/.pnpm/next%4016.1.0_%40babel%2Bcore%407.28.5_react-dom%4019.2.3_react%4019.2.3__react%4019.2.3/node_modules/next/src/server/route-modules/app-page/vendored/contexts/hooks-client-context.ts","../../../../node_modules/.pnpm/next%4016.1.0_%40babel%2Bcore%407.28.5_react-dom%4019.2.3_react%4019.2.3__react%4019.2.3/node_modules/next/src/server/route-modules/app-page/vendored/contexts/server-inserted-html.ts","../../../../src/app/reveal/page.tsx","../../../../src/content/loadingPhrases.ts","../../../../src/content/characters.ts","../../../../src/lib/fallback.ts"],"sourcesContent":["module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].AppRouterContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].HooksClientContext\n","module.exports = (\n  require('../../module.compiled') as typeof import('../../module.compiled')\n).vendored['contexts'].ServerInsertedHtml\n","\"use client\";\n\nimport { useEffect, useMemo, useState } from \"react\";\nimport { useRouter } from \"next/navigation\";\nimport { useGameState } from \"@/components/game-state-provider\";\nimport { QUESTIONS_BY_ID } from \"@/content/questions\";\nimport { LOADING_PHRASES } from \"@/content/loadingPhrases\";\nimport type { RevealResult } from \"@/types/game\";\nimport { getFallbackResult } from \"@/lib/fallback\";\n\nconst MIN_LOADING_MS = 2200;\n\nexport default function RevealPage() {\n  const router = useRouter();\n  const { state, ready, resetGame } = useGameState();\n  const [phase, setPhase] = useState<\"loading\" | \"reveal\">(\"loading\");\n  const [result, setResult] = useState<RevealResult | null>(null);\n  const [progress, setProgress] = useState(0);\n  const [phraseIndex, setPhraseIndex] = useState(0);\n\n  const payload = useMemo(() => {\n    if (!state) return null;\n    return {\n      name: state.name,\n      questions: state.questionIds\n        .map((id) => QUESTIONS_BY_ID.get(id))\n        .filter(Boolean)\n        .map((question) => ({\n          prompt: question!.prompt,\n          options: question!.options,\n        })),\n      answers: state.answers,\n    };\n  }, [state]);\n\n  useEffect(() => {\n    if (!ready) return;\n    if (!state || state.answers.length < 5) {\n      router.replace(\"/\");\n    }\n  }, [ready, state, router]);\n\n  useEffect(() => {\n    if (!payload) return;\n    let active = true;\n    const controller = new AbortController();\n    const start = Date.now();\n    const minDelay = MIN_LOADING_MS + Math.floor(Math.random() * 1200);\n\n    const run = async () => {\n      try {\n        const response = await fetch(\"/api/generate\", {\n          method: \"POST\",\n          headers: { \"Content-Type\": \"application/json\" },\n          body: JSON.stringify(payload),\n          signal: controller.signal,\n        });\n        const data = (await response.json()) as RevealResult;\n        const elapsed = Date.now() - start;\n        const wait = Math.max(0, minDelay - elapsed);\n        if (wait) {\n          await new Promise((resolve) => setTimeout(resolve, wait));\n        }\n        if (!active) return;\n        setResult(data);\n        setProgress(100);\n        setPhase(\"reveal\");\n      } catch {\n        if (!active) return;\n        const fallback = getFallbackResult(\n          `${state?.name ?? \"guest\"}${JSON.stringify(state?.answers ?? [])}`,\n        );\n        setResult(fallback);\n        setProgress(100);\n        setPhase(\"reveal\");\n      }\n    };\n\n    run();\n\n    return () => {\n      active = false;\n      controller.abort();\n    };\n  }, [payload, state]);\n\n  useEffect(() => {\n    if (phase !== \"loading\") return undefined;\n    const start = Date.now();\n    const id = setInterval(() => {\n      const elapsed = Date.now() - start;\n      const pct = Math.min(94, Math.round((elapsed / (MIN_LOADING_MS + 1200)) * 100));\n      setProgress((prev) => (prev > pct ? prev : pct));\n    }, 80);\n    return () => clearInterval(id);\n  }, [phase]);\n\n  useEffect(() => {\n    if (phase !== \"loading\") return undefined;\n    const id = setInterval(() => {\n      setPhraseIndex((prev) => (prev + 1) % LOADING_PHRASES.length);\n    }, 520);\n    return () => clearInterval(id);\n  }, [phase]);\n\n  if (phase === \"loading\") {\n    return (\n      <main className=\"min-h-screen flex items-center justify-center px-4 py-10\">\n        <div className=\"w-full max-w-xl rounded-[32px] border border-white/10 bg-black/50 p-8 text-center shadow-[0_30px_60px_rgba(0,0,0,0.45)] backdrop-blur\">\n          <p className=\"text-xs uppercase tracking-[0.35em] text-amber-200/80\">\n            Scanning Holiday Alignment\n          </p>\n          <h2 className=\"mt-4 text-4xl font-semibold font-[var(--font-heading)] text-amber-50\">\n            {LOADING_PHRASES[phraseIndex]}\n          </h2>\n          <div className=\"mt-8 h-3 w-full overflow-hidden rounded-full bg-white/10\">\n            <div\n              className=\"h-full rounded-full bg-gradient-to-r from-emerald-300 via-amber-300 to-red-400 transition-all\"\n              style={{ width: `${progress}%` }}\n            />\n          </div>\n          <p className=\"mt-3 text-sm text-white/60\">{progress}% complete</p>\n        </div>\n      </main>\n    );\n  }\n\n  if (!result) {\n    return (\n      <main className=\"min-h-screen flex items-center justify-center\">\n        <p className=\"text-white/70\">Summoning your result...</p>\n      </main>\n    );\n  }\n\n  return (\n    <main className=\"min-h-screen px-4 py-10 flex items-center justify-center\">\n      <div className=\"w-full max-w-3xl rounded-[32px] border border-white/10 bg-black/50 p-10 shadow-[0_30px_60px_rgba(0,0,0,0.45)] backdrop-blur\">\n        <p className=\"text-xs uppercase tracking-[0.35em] text-amber-200/80\">\n          Festive Fate Unlocked\n        </p>\n        <h1 className=\"mt-4 text-5xl sm:text-6xl font-semibold font-[var(--font-heading)] text-amber-50\">\n          YOU ARE: {result.characterName}\n        </h1>\n        {result.tagline ? (\n          <p className=\"mt-3 text-lg text-amber-200/90\">{result.tagline}</p>\n        ) : null}\n        <p className=\"mt-6 text-lg leading-relaxed text-white/85\">\n          {result.revealText}\n        </p>\n        <button\n          type=\"button\"\n          onClick={() => {\n            resetGame();\n            router.push(\"/\");\n          }}\n          className=\"mt-8 w-full rounded-2xl bg-red-400 px-6 py-4 text-lg font-semibold text-black shadow-[0_15px_30px_rgba(214,59,59,0.25)] transition hover:-translate-y-0.5\"\n        >\n          Play Again\n        </button>\n      </div>\n    </main>\n  );\n}\n","export const LOADING_PHRASES = [\n  \"Consulting the Naughty Ledger...\",\n  \"Shaking the snow globe...\",\n  \"Summoning seasonal spirits...\",\n  \"Untangling lights (pray for us)...\",\n  \"Counting reindeer (one is missing)...\",\n  \"Baking suspicious cookies...\",\n  \"Measuring holiday chaos...\",\n  \"Checking twice, regretting once...\",\n  \"Warming up the sleigh engine...\",\n  \"Rewrapping destiny...\",\n  \"Assembling your festive vibe...\",\n  \"Negotiating with the elves...\",\n  \"Lighting a candle for dramatic effect...\",\n  \"Opening the vault of jingles...\",\n  \"Searching for the perfect jingle...\",\n];\n","export const CHARACTERS = [\n  \"Santa Claus\",\n  \"Mall Santa\",\n  \"Rudolph\",\n  \"Non-Rudolph Reindeer\",\n  \"The Grinch\",\n  \"Krampus\",\n  \"Frosty the Snowman\",\n  \"Charlie Brown\",\n  \"Polar Bear\",\n  \"Orphan From a Christmas Movie\",\n  \"Blow-Up Inflatable Santa\",\n  \"Jesus\",\n  \"Baby Jesus\",\n  \"Jesus Dressed as Santa\",\n  \"Elf Union Organizer\",\n  \"The Mistletoe Menace\",\n  \"The Tree on the Roof of the Car\",\n  \"The Uninvited Caroler\",\n  \"The Eggnog Alchemist\",\n  \"The Gift Receipt Goblin\",\n  \"The Sleigh Mechanic\",\n  \"The Haunted Nutcracker\",\n  \"The Last-Minute Shopper\",\n  \"The Snow Day Extrovert\",\n  \"The Holiday Ghost Who Means Well\",\n];\n","import { CHARACTERS } from \"@/content/characters\";\nimport type { RevealResult } from \"@/types/game\";\n\nconst cannedLines = [\n  \"You radiate festive chaos with a hint of menace.\",\n  \"Your vibe says: jingle hard, sleep later.\",\n  \"People are not sure if youâ€™re a gift or a warning.\",\n  \"You show up late, but you always bring the plot twist.\",\n  \"Holiday cheer follows you, slightly out of breath.\",\n];\n\nconst hashString = (value: string) => {\n  let hash = 0;\n  for (let i = 0; i < value.length; i += 1) {\n    hash = (hash << 5) - hash + value.charCodeAt(i);\n    hash |= 0;\n  }\n  return Math.abs(hash);\n};\n\nexport const getFallbackResult = (seed: string): RevealResult => {\n  const hash = hashString(seed);\n  const characterName = CHARACTERS[hash % CHARACTERS.length] ?? \"Santa Claus\";\n  const revealText = cannedLines\n    .slice(0, 3 + (hash % 3))\n    .join(\" \");\n  return { characterName, revealText };\n};\n"],"names":["module","exports","require","vendored","AppRouterContext","HooksClientContext","ServerInsertedHtml"],"mappings":"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","ignoreList":[0,1,2]}